# ミーネクスト - プロダクト要件定義書 (PRD)

## 1. プロダクト概要

### 1.1 プロダクト名
**ミーネクスト (Minext)** - AI活用レシピ動画プラットフォーム

### 1.2 プロダクトビジョン
業務効率化のための実践的なAI活用ノウハウを、短尺動画で誰でも簡単に学べるプラットフォームを提供する。

### 1.3 ターゲットユーザー
- ChatGPTなどのAIツールを業務で活用したいビジネスパーソン
- 製造業・サービス業・医療介護などの現場スタッフ
- AI初心者から中級者まで幅広い層

---

## 2. UI/UX デザイン要件

### 2.1 トップページ (U-NEXTスタイル)

#### 2.1.1 ヒーローセクション
- **大きなビジュアル**: ブランドメッセージとCTA
- **メインコピー**: 「AIレシピで仕事を効率化」
- **サブコピー**: 「ChatGPTを使った実践的なビジネススキルを学ぼう」
- **CTAボタン**:
  - プレビューセンター (緑色、Primary)
  - 管理画面 (白色、Secondary)

#### 2.1.2 動画カードグリッド
```
レイアウト仕様:
- グリッド: 4列 × n行 (レスポンシブ)
- カードサイズ: 正方形に近い縦長 (16:9比率)
- ホバーエフェクト: 軽い拡大 + シャドウ
```

**カード構成要素:**
1. **サムネイル画像**
   - 動画のキーフレームまたは専用サムネイル
   - 再生アイコンオーバーレイ (▶マーク)
   - 再生時間バッジ (右下)

2. **メタ情報**
   - タイトル (2行まで表示)
   - 難易度バッジ (初級/中級/上級)
   - 業種バッジ (製造・医療・サービスなど)

3. **インタラクション**
   - クリック → 詳細ページへ遷移
   - ホバー → プレビュー動画自動再生 (optional)

#### 2.1.3 カテゴリーセクション
- **カテゴリーカード**: アイコン + 名称 + 件数
- **分類例**: 初心者向け、上級者向け、ビジネス、クリエイティブ

#### 2.1.4 人気レシピセクション
- **注目コンテンツ**: 大きめのカード表示
- **統計情報**: 視聴数、いいね数表示
- **ランキング表示**: 人気No.1 バッジ

---

### 2.2 詳細ページ (クラシルスタイル)

#### 2.2.1 ページレイアウト
```
+-------------------------------------------+
|  動画プレイヤー (正方形、中央配置)          |
+-------------------------------------------+
|  タイトル                                  |
|  メタ情報 (保存数/視聴数/評価/所要時間)    |
|  保存・共有ボタン                          |
+-------------------------------------------+
|  導入文                                    |
+-------------------------------------------+
|  タグ                                      |
+-------------------------------------------+
|  材料(必要なもの)                          |
|  - ChatGPT (無料プランOK)                  |
|  - その他ツール                            |
+-------------------------------------------+
|  手順                                      |
|  [1] 手順1のタイトル                       |
|      説明文                                |
|      [画像]                                |
|      [プロンプト例] ← コピーボタン付き     |
|      [テクニック] ← tips表示               |
|  [2] 手順2...                             |
+-------------------------------------------+
|  コツ・ポイント                            |
|  - 箇条書きリスト                          |
+-------------------------------------------+
|  アクションボタン                          |
|  [質問する] [オリジナルをシェアする]       |
+-------------------------------------------+
```

#### 2.2.2 左側メインコンテンツ

**A. 動画プレイヤー**
- **表示形式**: 正方形 (1:1比率)、最大幅600px、中央配置
- **機能**:
  - 再生/一時停止
  - シークバー
  - 音量調整
  - 全画面表示
  - 画質選択 (HLS対応時)

**B. タイトル・メタ情報**
- **タイトル**: 大きめフォント (2.2rem)
- **メタ情報**:
  - 保存数 (ブックマークアイコン)
  - 視聴数 (目のアイコン)
  - 評価 (星5つ + スコア)
  - 所要時間 (時計アイコン)
- **アクションボタン**:
  - 保存ボタン (黒背景、白文字)
  - 共有ボタン (黒背景、白文字)

**C. 導入文**
- レシピの概要説明
- 誰向けか、どんな課題を解決するか

**D. タグ**
- 緑背景の丸みのあるタグ
- 例: #製造・現場職場 #メモ取り #ChatGPT #初心者

**E. 材料(必要なもの)**
- セクションタイトル (下線付き、左30%に緑のアクセントライン)
- リスト形式:
  - 項目名 | 備考
  - 例: ChatGPT | 無料プランOK

**F. 手順セクション**
- **手順番号**: 大きな緑色の円形バッジ (左上に配置)
- **各手順の構成**:
  1. 手順タイトル (緑色、1.4rem)
  2. 説明文
  3. 画像またはプレースホルダー
  4. プロンプト例ボックス (該当手順のみ)
     - ヘッダー: 「プロンプト例」+ コピーボタン
     - 内容: モノスペースフォント、白背景
  5. テクニックボックス (該当手順のみ)
     - アイコン: 電球マーク
     - 灰色背景、tips表示

**G. コツ・ポイント**
- セクションタイトル (下線付き)
- 箇条書きリスト
- 実践的なアドバイス

**H. アクションボタン**
- 質問する (黒背景、Primary)
- オリジナルをシェアする (白背景、黒枠線、Secondary)

#### 2.2.3 右側サイドバー (幅350px)

**A. 関連レシピ**
- セクションタイトル: 「このAIレシピに関連するレシピ」
- カード構成:
  - サムネイル (60×45px)
  - タイトル (1行)
  - 説明 (2行まで省略表示)

**B. 今週の人気ランキング**
- セクションタイトル: 「今週の人気ランキング」
- ランキング番号 (緑色の円形バッジ)
- カード構成:
  - サムネイル
  - タイトル
  - 説明文

---

## 3. 機能要件

### 3.1 動画関連機能

#### 3.1.1 動画再生
- [ ] MP4動画の基本再生
- [ ] HLS配信対応 (複数画質)
- [ ] 自動画質切り替え
- [ ] 再生速度変更 (0.5x, 0.75x, 1x, 1.25x, 1.5x, 2x)
- [ ] 10秒スキップ (前/後)
- [ ] ピクチャーインピクチャー

#### 3.1.2 動画アップロード・処理
- [ ] 管理画面からの動画アップロード
- [ ] FFmpegによる動画変換
  - 複数解像度生成 (240p, 360p, 480p, 720p, 1080p)
  - HLSセグメント生成
  - サムネイル自動生成
- [ ] S3へのアップロード
- [ ] CloudFront経由の配信

### 3.2 検索・フィルタリング

#### 3.2.1 検索条件
- [ ] フリーワード検索 (タイトル、説明文、タグ)
- [ ] 業種フィルタ (製造、医療、サービス、教育、etc)
- [ ] 用途フィルタ (資料作成、会議効率化、データ分析、etc)
- [ ] 難易度フィルタ (初級、中級、上級)
- [ ] 所要時間フィルタ (1分以内、3分以内、5分以内、etc)
- [ ] タグフィルタ

#### 3.2.2 並び替え
- [ ] 新着順
- [ ] 人気順 (視聴数)
- [ ] 評価順
- [ ] 所要時間順

### 3.3 ユーザー機能

#### 3.3.1 認証・アカウント
- [ ] ユーザー登録 (メールアドレス)
- [ ] ログイン/ログアウト
- [ ] パスワードリセット
- [ ] プロフィール編集

#### 3.3.2 ユーザーアクション
- [ ] レシピ保存 (ブックマーク)
- [ ] レシピ評価 (5段階)
- [ ] レシピ共有 (SNS連携)
- [ ] コメント投稿
- [ ] 質問投稿

#### 3.3.3 学習履歴
- [ ] 視聴履歴
- [ ] 視聴進捗保存
- [ ] おすすめレシピ表示
- [ ] 学習統計 (ダッシュボード)

### 3.4 プレミアム機能

#### 3.4.1 アクセス制御
- [ ] 無料会員: 一部レシピのみ視聴可能
- [ ] プレミアム会員: 全レシピ視聴可能
- [ ] プレビュー機能 (最初の30秒のみ視聴)

#### 3.4.2 決済
- [ ] Stripe連携
- [ ] サブスクリプション管理
- [ ] 請求書発行

### 3.5 管理機能

#### 3.5.1 レシピ管理
- [ ] レシピ作成
- [ ] レシピ編集
- [ ] レシピ削除
- [ ] 手順管理 (CRUD)
- [ ] タグ管理
- [ ] 公開/非公開切り替え

#### 3.5.2 ユーザー管理
- [ ] ユーザー一覧
- [ ] ユーザー詳細
- [ ] 権限管理
- [ ] アクセスログ

#### 3.5.3 統計・分析
- [ ] 視聴統計
- [ ] ユーザー統計
- [ ] 売上統計
- [ ] レポート出力

---

## 4. データモデル

### 4.1 主要エンティティ

#### Recipe (レシピ)
```ruby
{
  id: integer,
  title: string,              # タイトル
  description: text,          # 説明文
  video_url: string,          # 動画URL (開発用)
  hls_master_url: string,     # HLSマスタープレイリストURL
  thumbnail_url: string,      # サムネイルURL
  thumbnail_s3_key: string,   # S3キー
  video_qualities: json,      # 利用可能な画質情報
  duration_minutes: integer,  # 所要時間
  industry: string,           # 業種
  purpose: string,            # 用途
  difficulty_level: string,   # 難易度 (初級/中級/上級)
  access_level: string,       # アクセスレベル (free/premium)
  preview_seconds: integer,   # プレビュー秒数
  processing_status: string,  # 処理状態 (pending/processing/completed/failed)
  view_count: integer,        # 視聴数
  save_count: integer,        # 保存数
  rating_average: decimal,    # 平均評価
  rating_count: integer,      # 評価数
  created_at: datetime,
  updated_at: datetime
}
```

#### RecipeStep (手順)
```ruby
{
  id: integer,
  recipe_id: integer,
  step_number: integer,       # 手順番号
  title: string,              # 手順タイトル
  description: text,          # 手順説明
  image_url: string,          # 手順画像URL
  prompt_example: text,       # プロンプト例
  technique_note: text,       # テクニックメモ
  created_at: datetime,
  updated_at: datetime
}
```

#### Tag (タグ)
```ruby
{
  id: integer,
  name: string,               # タグ名
  category: string,           # カテゴリ (industry/tool/skill/etc)
  created_at: datetime,
  updated_at: datetime
}
```

#### User (ユーザー)
```ruby
{
  id: integer,
  email: string,
  password_digest: string,
  name: string,
  subscription_level: string, # free/premium
  subscription_expires_at: datetime,
  created_at: datetime,
  updated_at: datetime
}
```

#### UserAction (ユーザーアクション)
```ruby
{
  id: integer,
  user_id: integer,
  recipe_id: integer,
  action_type: string,        # view/save/rate/comment
  rating: integer,            # 1-5
  comment: text,
  created_at: datetime,
  updated_at: datetime
}
```

---

## 5. 技術スタック

### 5.1 現在の技術スタック
- **バックエンド**: Ruby (Sinatra)
- **データベース**: SQLite3 (開発), PostgreSQL (本番)
- **フロントエンド**: HTML/CSS/JavaScript (ERB)
- **デプロイ**: Railway, Docker

### 5.2 今後追加予定の技術
- **動画処理**: FFmpeg
- **ストレージ**: AWS S3
- **CDN**: AWS CloudFront
- **決済**: Stripe
- **認証**: Devise, JWT
- **ジョブキュー**: Sidekiq, Redis

---

## 6. 非機能要件

### 6.1 パフォーマンス
- [ ] ページ読み込み時間: 2秒以内
- [ ] 動画バッファリング: 1秒以内
- [ ] APIレスポンス: 500ms以内
- [ ] 同時接続数: 1000ユーザー以上

### 6.2 セキュリティ
- [ ] HTTPS通信
- [ ] パスワード暗号化 (bcrypt)
- [ ] XSS対策
- [ ] CSRF対策
- [ ] SQLインジェクション対策
- [ ] 署名付きURL (動画配信)

### 6.3 スケーラビリティ
- [ ] 水平スケーリング対応
- [ ] CDN活用
- [ ] キャッシング戦略
- [ ] データベースレプリケーション

### 6.4 可用性
- [ ] 稼働率: 99.9%以上
- [ ] バックアップ: 日次
- [ ] 監視・アラート
- [ ] ログ管理

---

## 7. UI/UXデザイン仕様詳細

### 7.1 カラースキーム
```css
Primary Color:   #4CAF50 (緑)
Secondary Color: #333333 (黒)
Background:      #f8f9fa (薄いグレー)
Card Background: #ffffff (白)
Text Primary:    #333333
Text Secondary:  #666666
Border:          #e0e0e0
Success:         #4CAF50
Error:           #e53e3e
```

### 7.2 タイポグラフィ
```css
Font Family:
  - システムフォント優先
  - 'Hiragino Sans', 'Hiragino Kaku Gothic ProN',
    'Yu Gothic', 'Meiryo', sans-serif

Font Sizes:
  - Hero Title:      2.5rem (40px)
  - Section Title:   1.5rem (24px)
  - Card Title:      1.1rem (18px)
  - Body Text:       1rem (16px)
  - Small Text:      0.9rem (14px)
```

### 7.3 スペーシング
```css
Padding/Margin:
  - XS: 0.5rem (8px)
  - SM: 1rem (16px)
  - MD: 1.5rem (24px)
  - LG: 2rem (32px)
  - XL: 3rem (48px)

Border Radius:
  - Small:  4px
  - Medium: 8px
  - Large:  12px
  - XLarge: 16px
  - Round:  50% (円形)
```

### 7.4 レスポンシブブレークポイント
```css
Mobile:  < 768px
Tablet:  768px - 1024px
Desktop: > 1024px

Grid Columns:
  - Mobile:  1列
  - Tablet:  2列
  - Desktop: 4列
```

### 7.5 アニメーション
```css
Transition Duration: 0.3s
Easing: ease-in-out

Hover Effects:
  - Card: translateY(-2px) + shadow
  - Button: background color change + translateY(-1px)
```

---

## 8. 実装優先度

### Phase 1: MVP (最小限の機能)
1. ✅ 基本的なUI実装 (トップページ、詳細ページ)
2. ✅ レシピCRUD
3. ✅ 動画再生 (MP4)
4. [ ] 手順管理機能
5. [ ] タグ機能

### Phase 2: コア機能
1. [ ] ユーザー認証
2. [ ] 検索・フィルタリング
3. [ ] 保存・評価機能
4. [ ] HLS動画配信
5. [ ] 動画処理パイプライン

### Phase 3: プレミアム機能
1. [ ] サブスクリプション
2. [ ] 決済機能
3. [ ] アクセス制御
4. [ ] おすすめ機能

### Phase 4: 拡張機能
1. [ ] コメント機能
2. [ ] 質問機能
3. [ ] SNS連携
4. [ ] AI連携 (レシピ生成)

---

## 9. 成功指標 (KPI)

### 9.1 ビジネスKPI
- 月間アクティブユーザー数 (MAU)
- プレミアム会員登録率
- 月次経常収益 (MRR)
- 解約率 (Churn Rate)

### 9.2 エンゲージメントKPI
- 平均視聴時間
- 動画完視率
- 保存率
- 共有率
- リピート率

### 9.3 技術KPI
- ページ読み込み時間
- 動画バッファリング時間
- エラー率
- 稼働率

---

## 10. 開発ロードマップ

### Q1 2025
- [x] プロジェクト初期セットアップ
- [x] 基本UI実装
- [ ] ユーザー認証実装
- [ ] 検索機能実装

### Q2 2025
- [ ] HLS動画配信
- [ ] 動画処理パイプライン
- [ ] サブスクリプション機能

### Q3 2025
- [ ] プレミアム機能
- [ ] モバイルアプリ開発
- [ ] パフォーマンス最適化

### Q4 2025
- [ ] AI連携機能
- [ ] 分析ダッシュボード
- [ ] マーケティング機能

---

## 付録

### A. 参考サイト
- **U-NEXT**: https://video.unext.jp/
  - 動画一覧のグリッドレイアウト
  - ホバーエフェクト
  - カテゴリー分類

- **クラシル**: https://www.kurashiru.com/
  - レシピ詳細ページのレイアウト
  - 手順の見せ方
  - サイドバーのおすすめ表示

### B. デザインリソース
- Material Icons: https://fonts.google.com/icons
- カラーパレット: Material Design Colors

### C. 技術ドキュメント
- Sinatra: http://sinatrarb.com/
- FFmpeg: https://ffmpeg.org/
- HLS: https://developer.apple.com/streaming/
- Stripe: https://stripe.com/docs

---

**最終更新**: 2025-01-28
**バージョン**: 1.0.0
**作成者**: ミーネクスト開発チーム